<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>{{ name }} - Ewha Market</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
  {% include 'navbar.html' %}

  <div class="container">
    <div class="detail">

      <!-- 상품 이미지 -->
      <div>
        <img src="{{ url_for('static', filename='image/' ~ data.image) }}" width="400" height="400">
      </div>

      <!-- 상품 정보 -->
      <div>
        <h2>
          {{ name }}
          <i class="fa fa-heart" id="heart"></i>
        </h2>

        <p style="font-size:20px; font-weight:700;">
          ₩{{ data.price }}
        </p>

        <button class="btn">구매하기</button>
        <button class="btn" onclick="location.href='/reg_review_init/{{ name }}/'">
  리뷰 등록하기
</button>


        <!-- 상품 정보 -->
        <div class="card" style="margin-top:20px;">
          <h3>상품 정보</h3>
          <p>카테고리: {{ data.category }}</p>
          <p>상품 상태: {{ data.condition }}</p>
          <p>상품 설명{{ data.desc }}</p>
        </div>

        <!-- 판매자 정보 -->
        <div class="card" style="margin-top:20px;">
          <h3>판매자 정보</h3>
          <p>판매자: {{ data.seller }}</p>
          <p>거래 위치: {{ data.location }}</p>
        </div>


        <div class="card" style="margin-top:20px;">
          <h3>결제 방식</h3>
          <p>
            For payment, the credit card is
            {% if data.card == "Y" %}
              <b>accepted!</b>
            {% elif data.card == "N" %}
              <b>NOT accepted!</b>
            {% else %}
              <b>unknown</b>
            {% endif %}
          </p>
        </div>

      </div>
    </div>
  </div>
  
<!-- 하트상태조회(좋아요클릭) -->

 <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  
  <script>

    function showHeart() {
      $.ajax({
        type: 'Get',
        url: '/show_heart/{{name}}/',
        data: {},
        success: function(response) {
          let my_heart = response['my_heart'];

          if (my_heart['interested'] == 'Y') {
            $("#heart").css("color", "red");
            $("#heart").attr("onclick", "unlike()");
          } else {
            $("#heart").css("color", "grey");
            $("#heart").attr("onclick", "like()");
          }
        }
      });
    }

    function like() {
      $.ajax({
        type: 'POST',
         url: '/like/{{name}}/',
        data: {
          interested: "Y"
        },
        success: function(response) {
          alert(response['msg']);
          window.location.reload();
        }
      });
    }

    function unlike() {
      $.ajax({
        type: 'POST',
        url: '/unlike/{{name}}/',
        data: {
          interested: "N"
        },
        success: function(response) {
          alert(response['msg']);
          window.location.reload();
        }
      });
    }

    $(document).ready(function () {
      showHeart();
    });

  </script>

  <script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>
